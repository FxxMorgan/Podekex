<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pokedex</title>
  <link rel="stylesheet" href="css/main.css">
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="path/to/fontawesome/css/all.min.css">

  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="libs/gsap/gsap.min.js" defer></script>
  <script src="libs/gsap/ScrollTrigger.min.js" defer></script>
  <script src="libs/gsap/ScrollSmoother.min.js" defer></script>
  <script src="js/app.js" defer></script>

  <style>
    /* Estilos CSS adicionales */
  </style>
</head>
<body>
  <div class="wrapper">
    <div class="content">
      <header class="main-header">
        <div class="layers">
          <div class="layer__header">
            <div class="layers__caption">Bienvenidos a</div>
            <div class="layers__title">Â¡Pokemon!</div>
          </div>
          <div class="layer layers__base" style="background-image: url(img/layer-base.png);"></div>
          <div class="layer layers__middle" style="background-image: url(img/layer-middle.png);"></div>
          <div class="layer layers__front" style="background-image: url(img/layer-front.png);"></div>
        </div>
      </header>
      <article class="main-article" style="background-image: url(img/dungeon.jpg);">
        <div class="main-article__content">
          <h2 class="main-article__header">Tierra de misterios &amp; aventuras</h2>
          <p class="main-article__paragraph">Texto de ejemplo</p>
        </div>
      </article>
      <div id="pokedex" class="pokedex"></div>
    </div>
  </div>
  <script>
    async function getPokemonData(pokemonId) {
      try {
        const response = await axios.get(`https://pokeapi.co/api/v2/pokemon/${pokemonId}`);
        const pokemon = response.data;

        const speciesResponse = await axios.get(pokemon.species.url);
        const speciesData = speciesResponse.data;

        const flavorTextEntries = speciesData.flavor_text_entries.filter(entry => entry.language.name === 'es');
        const description = flavorTextEntries.length > 0 ? flavorTextEntries[0].flavor_text : '';

        const types = await Promise.all(
          pokemon.types.map(async (type) => {
            const typeResponse = await axios.get(type.type.url);
            const typeName = typeResponse.data.names.find((name) => name.language.name === 'es').name;
            return typeName;
          })
        );

        pokemon.types = types;
        pokemon.description = description;

        return pokemon;
      } catch (error) {
        console.error(error);
      }
    }

    let page = 1;
    const limit = 20;
    let isLoading = false;

    window.onscroll = async () => {
      if (!isLoading && window.scrollY + window.innerHeight >= document.documentElement.offsetHeight) {
        isLoading = true;
        page++;
        await generatePokedex();
        isLoading = false;
      }
    };

    async function generatePokedex() {
      const pokedexContainer = document.getElementById('pokedex');
      for (let i = (page - 1) * limit + 1; i <= page * limit; i++) {
        const pokemon = await getPokemonData(i);

        const pokemonElement = document.createElement('div');
        pokemonElement.classList.add('pokemon');
        pokemon.types.forEach(type => pokemonElement.classList.add(type.toLowerCase()));

        const pokemonNumber = i.toString().padStart(3, '0');
        const imagePath = `assets/pokemon/${pokemonNumber}.png`;

        pokemonElement.style.backgroundImage = `url(${imagePath})`;

        pokemonElement.innerHTML = `
          <div class="pokemon-info">
            <h3>${pokemon.name}</h3>
            <p>Tipo: ${pokemon.types.join(', ')}</p>
            <p>${pokemon.description}</p>
          </div>
        `;

        pokedexContainer.appendChild(pokemonElement);
      }
    }

    generatePokedex();

    window.onscroll = async () => {
      if (window.scrollY + window.innerHeight >= document.documentElement.offsetHeight) {
        page++;
        await generatePokedex();
      }
    }

    function getBackgroundColor(types) {
      const colors = {
        normal: '#A8A878',
        fire: '#F08030',
        water: '#6890F0',
        electric: '#F8D030',
        grass: '#78C850',
        ice: '#98D8D8',
        fighting: '#C03028',
        poison: '#A040A0',
        ground: '#E0C068',
        flying: '#A890F0',
        psychic: '#F85888',
        bug: '#A8B820',
        rock: '#B8A038',
        ghost: '#705898',
        dragon: '#7038F8',
        dark: '#705848',
        steel: '#B8B8D0',
        fairy: '#EE99AC',
      };

      const backgroundColors = types.map(type => colors[type.toLowerCase()]);
      const gradientColors = backgroundColors.length > 1 ? backgroundColors : [backgroundColors[0], backgroundColors[0]];

      const bgColor = `linear-gradient(90deg, ${gradientColors[0]} 50%, ${gradientColors[1]} 50%)`;
      return bgColor;
    }
  </script>
</body>
</html>